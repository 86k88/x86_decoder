#pragma once
#include <stdint.h>

typedef struct opcode_desc_s {
    uint64_t bits;
} opcode_desc_t;

/*
Bit layout:
- Low bits are the classic decode traits (ModRM/imm/rep/lock/etc.)
- High bits add verbose operand classes + mandatory prefix variants + /digit bits.
*/

#define OP_HAS_MODRM UINT64_C(0x0000000000000001)
#define OP_HAS_SIB UINT64_C(0x0000000000000002)
#define OP_HAS_DISP UINT64_C(0x0000000000000004)
#define OP_HAS_IMM UINT64_C(0x0000000000000008)
#define OP_IMM8 UINT64_C(0x0000000000000010)
#define OP_IMM16 UINT64_C(0x0000000000000020)
#define OP_IMM32 UINT64_C(0x0000000000000040)
#define OP_IMM_OPSZ UINT64_C(0x0000000000000080)
#define OP_GROUP UINT64_C(0x0000000000000100)
#define OP_REG_IN_OP UINT64_C(0x0000000000000200)
#define OP_TWO_BYTE UINT64_C(0x0000000000000400)
#define OP_LOCKABLE UINT64_C(0x0000000000000800)
#define OP_REPABLE UINT64_C(0x0000000000001000)
#define OP_OPSZ_OK UINT64_C(0x0000000000002000)
#define OP_ADSZ_OK UINT64_C(0x0000000000004000)
#define OP_STRING UINT64_C(0x0000000000008000)
#define OP_CONTROL UINT64_C(0x0000000000010000)
#define OP_STACK UINT64_C(0x0000000000020000)
#define OP_TESTS_CF UINT64_C(0x0000000000040000)
#define OP_TESTS_ZF UINT64_C(0x0000000000080000)
#define OP_TESTS_SF UINT64_C(0x0000000000100000)
#define OP_TESTS_OF UINT64_C(0x0000000000200000)
#define OP_TESTS_PF UINT64_C(0x0000000000400000)
#define OP_MOD_CF UINT64_C(0x0000000000800000)
#define OP_MOD_ZF UINT64_C(0x0000000001000000)
#define OP_MOD_SF UINT64_C(0x0000000002000000)
#define OP_MOD_OF UINT64_C(0x0000000004000000)
#define OP_MOD_PF UINT64_C(0x0000000008000000)
#define OP_NO_OPERANDS UINT64_C(0x0000000010000000)
#define OP_IMM16_8 UINT64_C(0x0000000020000000)
#define OP_FAR_PTR UINT64_C(0x0000000040000000)
#define OP_MOFFS UINT64_C(0x0000000080000000)
#define OP_REPNEABLE UINT64_C(0x0000000100000000)

/* Verbose operand-class flags (decoder asks: “could this opcode touch X?”) */
#define OP_OPCL_REG UINT64_C(0x0000000200000000)
#define OP_OPCL_MEM UINT64_C(0x0000000400000000)
#define OP_OPCL_RM  UINT64_C(0x0000000800000000)
#define OP_OPCL_XMM UINT64_C(0x0000001000000000)
#define OP_OPCL_YMM UINT64_C(0x0000002000000000)
#define OP_OPCL_ZMM UINT64_C(0x0000004000000000)
#define OP_OPCL_MM  UINT64_C(0x0000008000000000)
#define OP_OPCL_ST  UINT64_C(0x0000010000000000)
#define OP_OPCL_IMM UINT64_C(0x0000020000000000)
#define OP_OPCL_REL UINT64_C(0x0000040000000000)
#define OP_OPCL_MOFFS UINT64_C(0x0000080000000000)
#define OP_OPCL_FAR   UINT64_C(0x0000100000000000)

/* Mandatory prefix variants observed (across collapsed rows) */
#define OP_MAND_66 UINT64_C(0x0000200000000000)
#define OP_MAND_F2 UINT64_C(0x0000400000000000)
#define OP_MAND_F3 UINT64_C(0x0000800000000000)
#define OP_MAND_9B UINT64_C(0x0001000000000000)

/* This opcode collapses multiple variants (prefix and/or /digit and/or multiple encodings) */
#define OP_HAS_VARIANTS UINT64_C(0x0002000000000000)

/* ModRM /digit presence (group sub-opcodes present) */
#define OP_EXT0 UINT64_C(0x0004000000000000)
#define OP_EXT1 UINT64_C(0x0008000000000000)
#define OP_EXT2 UINT64_C(0x0010000000000000)
#define OP_EXT3 UINT64_C(0x0020000000000000)
#define OP_EXT4 UINT64_C(0x0040000000000000)
#define OP_EXT5 UINT64_C(0x0080000000000000)
#define OP_EXT6 UINT64_C(0x0100000000000000)
#define OP_EXT7 UINT64_C(0x0200000000000000)
